<!DOCTYPE html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Project page of the SMUR Vertically Integrated Project at Georgia Tech."><meta name=author content="Patrick Kastner"><link href=https://vip-smur.github.io/25fa-mponc/ rel=canonical><link href=../25fa-medialaxis/ rel=prev><link href=../25fa-energyinbuildings/ rel=next><link rel=alternate type=application/rss+xml title="RSS feed" href=../feed_rss_created.xml><link rel=alternate type=application/rss+xml title="RSS feed of updated content" href=../feed_rss_updated.xml><link rel=icon href=../images/favicon.svg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.0"><title>25-Fa-MPONC - Surrogate Modeling for Urban Regeneration (SMUR)</title><link rel=stylesheet href=../assets/stylesheets/main.618322db.min.css><link rel=stylesheet href=../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../css/timeago.css><link rel=stylesheet href=../stylesheets/extra.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script>
    /* Add custom analytics integration here, e.g. */
    var property = "" 
  
    /* Load Umami script */
    var umamiScript = document.createElement('script');
    umamiScript.defer = true;
    umamiScript.src = "https://cloud.umami.is/script.js";
    umamiScript.setAttribute('data-website-id', "ec8516ed-7cf7-4950-a1c9-555b3fafb1f4");
    document.head.appendChild(umamiScript);
  
    /* Wait for page to load and application to mount */
    document.addEventListener("DOMContentLoaded", function() {
      location$.subscribe(function(url) {
        /* Add custom page event tracking here */ 
        if (window.umami) {
          umami.trackView(url);
        }
      })
    })
  </script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><meta property=og:type content=website><meta property=og:title content="25-Fa-MPONC - Surrogate Modeling for Urban Regeneration (SMUR)"><meta property=og:description content="Project page of the SMUR Vertically Integrated Project at Georgia Tech."><meta property=og:image content=https://vip-smur.github.io/assets/images/social/25fa-mponc/index.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta content=https://vip-smur.github.io/25fa-mponc/ property=og:url><meta property=twitter:card content=summary_large_image><meta property=twitter:title content="25-Fa-MPONC - Surrogate Modeling for Urban Regeneration (SMUR)"><meta property=twitter:description content="Project page of the SMUR Vertically Integrated Project at Georgia Tech."><meta property=twitter:image content=https://vip-smur.github.io/assets/images/social/25fa-mponc/index.png><link href=../assets/stylesheets/glightbox.min.css rel=stylesheet><script src=../assets/javascripts/glightbox.min.js></script><style id=glightbox-style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#modeling-processes-of-neighborhood-change-mponc class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="Surrogate Modeling for Urban Regeneration (SMUR)" class="md-header__button md-logo" aria-label="Surrogate Modeling for Urban Regeneration (SMUR)" data-md-component=logo> <img src=../images/favicon.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Surrogate Modeling for Urban Regeneration (SMUR) </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 25-Fa-MPONC </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=black data-md-color-accent=black aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/VIP-SMUR/vip-smur.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../projects/ class=md-tabs__link> Projects </a> </li> <li class=md-tabs__item> <a href=../team/ class=md-tabs__link> Team </a> </li> <li class=md-tabs__item> <a href=../activities/ class=md-tabs__link> Activities </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Surrogate Modeling for Urban Regeneration (SMUR)" class="md-nav__button md-logo" aria-label="Surrogate Modeling for Urban Regeneration (SMUR)" data-md-component=logo> <img src=../images/favicon.svg alt=logo> </a> Surrogate Modeling for Urban Regeneration (SMUR) </label> <div class=md-nav__source> <a href=https://github.com/VIP-SMUR/vip-smur.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1> <div class="md-nav__link md-nav__container"> <a href=.. class="md-nav__link "> <span class=md-ellipsis> Home </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__container"> <a href=../projects/ class="md-nav__link "> <span class=md-ellipsis> Projects </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2 checked> <div class="md-nav__link md-nav__container"> <a href=../projects/25fa/ class="md-nav__link "> <span class=md-ellipsis> Fall 2025 </span> </a> <label class="md-nav__link " for=__nav_2_2 id=__nav_2_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Fall 2025 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../25fa-medialaxis/ class=md-nav__link> <span class=md-ellipsis> 25-Fa-MedialAxis </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 25-Fa-MPONC </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 25-Fa-MPONC </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#reference-paper class=md-nav__link> <span class=md-ellipsis> Reference paper </span> </a> </li> <li class=md-nav__item> <a href=#setup class=md-nav__link> <span class=md-ellipsis> Setup </span> </a> </li> <li class=md-nav__item> <a href=#abstract class=md-nav__link> <span class=md-ellipsis> Abstract </span> </a> </li> <li class=md-nav__item> <a href=#intro-and-description class=md-nav__link> <span class=md-ellipsis> Intro and Description </span> </a> </li> <li class=md-nav__item> <a href=#cost-function class=md-nav__link> <span class=md-ellipsis> Cost Function </span> </a> <nav class=md-nav aria-label="Cost Function"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#attractiveness-upkeep-amenity_access-beltline_factor class=md-nav__link> <span class=md-ellipsis> Attractiveness = upkeep × amenity_access × beltline_factor </span> </a> </li> <li class=md-nav__item> <a href=#spatial-smoothing-of-amenity-data class=md-nav__link> <span class=md-ellipsis> Spatial Smoothing of Amenity Data </span> </a> <nav class=md-nav aria-label="Spatial Smoothing of Amenity Data"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#implemented-amenities-weights-openstreetmap-labels class=md-nav__link> <span class=md-ellipsis> Implemented Amenities &amp; weights (OpenStreetMap labels): </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#community-score-local-morans-i class=md-nav__link> <span class=md-ellipsis> Community Score (Local Moran’s I) </span> </a> </li> <li class=md-nav__item> <a href=#weighting-amenity-access-vs-community class=md-nav__link> <span class=md-ellipsis> Weighting amenity access vs community (λ) </span> </a> </li> <li class=md-nav__item> <a href=#tigerline-geodatabases-shapefiles class=md-nav__link> <span class=md-ellipsis> TIGER/Line Geodatabases shapefiles: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#project-status class=md-nav__link> <span class=md-ellipsis> Project status </span> </a> <nav class=md-nav aria-label="Project status"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#outputs-configuration class=md-nav__link> <span class=md-ellipsis> Outputs &amp; configuration </span> </a> <nav class=md-nav aria-label="Outputs & configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gif class=md-nav__link> <span class=md-ellipsis> GIF </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#runtimes class=md-nav__link> <span class=md-ellipsis> Runtimes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#census-based-approach class=md-nav__link> <span class=md-ellipsis> Census-based approach </span> </a> </li> <li class=md-nav__item> <a href=#atlanta-beltline-in-our-simulation class=md-nav__link> <span class=md-ellipsis> Atlanta Beltline in our Simulation </span> </a> </li> <li class=md-nav__item> <a href=#adapting-the-model-to-other-cities class=md-nav__link> <span class=md-ellipsis> Adapting the Model to Other Cities </span> </a> </li> <li class=md-nav__item> <a href=#policy-scenarios-vertical-vs-horizontal-scaling class=md-nav__link> <span class=md-ellipsis> Policy Scenarios: Vertical vs Horizontal Scaling </span> </a> <nav class=md-nav aria-label="Policy Scenarios: Vertical vs Horizontal Scaling"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-vertical-scaling-decision-making-agent-learns-kappa class=md-nav__link> <span class=md-ellipsis> 1. Vertical Scaling — Decision-Making Agent learns \(\kappa\) </span> </a> <nav class=md-nav aria-label="1. Vertical Scaling — Decision-Making Agent learns \(\kappa\)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#effective-multiplier class=md-nav__link> <span class=md-ellipsis> Effective multiplier </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-horizontal-scaling-complete-beltline-from-day-0 class=md-nav__link> <span class=md-ellipsis> 2. Horizontal Scaling (complete BeltLine from day 0) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#strengths-and-weaknesses class=md-nav__link> <span class=md-ellipsis> Strengths and Weaknesses </span> </a> <nav class=md-nav aria-label="Strengths and Weaknesses"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#strengths class=md-nav__link> <span class=md-ellipsis> Strengths </span> </a> </li> <li class=md-nav__item> <a href=#weaknesses class=md-nav__link> <span class=md-ellipsis> Weaknesses </span> </a> </li> <li class=md-nav__item> <a href=#next-steps class=md-nav__link> <span class=md-ellipsis> Next Steps </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../25fa-energyinbuildings/ class=md-nav__link> <span class=md-ellipsis> 25-Fa-Energy </span> </a> </li> <li class=md-nav__item> <a href=../25fa-microclimate-ml/ class=md-nav__link> <span class=md-ellipsis> 25-Fa-Microclimate-ML </span> </a> </li> <li class=md-nav__item> <a href=../25fa-microclimate-outdoorplus/ class=md-nav__link> <span class=md-ellipsis> 25-Fa-Microclimate-Outdoor+ </span> </a> </li> <li class=md-nav__item> <a href=../25fa-mobility/ class=md-nav__link> <span class=md-ellipsis> 25-Fa-Mobility </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_3> <div class="md-nav__link md-nav__container"> <a href=../projects/25sp/ class="md-nav__link "> <span class=md-ellipsis> Spring 2025 </span> </a> <label class="md-nav__link " for=__nav_2_3 id=__nav_2_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Spring 2025 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../25sp-neuroarchitecture/ class=md-nav__link> <span class=md-ellipsis> 25-Sp-Neuroarchitecture </span> </a> </li> <li class=md-nav__item> <a href=../25sp-mponc/ class=md-nav__link> <span class=md-ellipsis> 25-Sp-MPONC </span> </a> </li> <li class=md-nav__item> <a href=../25sp-energyinbuildings/ class=md-nav__link> <span class=md-ellipsis> 25-Sp-Energy </span> </a> </li> <li class=md-nav__item> <a href=../25sp-microclimate-lstm-kriging/ class=md-nav__link> <span class=md-ellipsis> 25-Sp-Microclimate-LSTM-Kriging </span> </a> </li> <li class=md-nav__item> <a href=../25sp-microclimate-umcf/ class=md-nav__link> <span class=md-ellipsis> 25-Sp-Microclimate-UMCF </span> </a> </li> <li class=md-nav__item> <a href=../25sp-mobility-pei/ class=md-nav__link> <span class=md-ellipsis> 25-Sp-Mobility-PEI </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_4> <div class="md-nav__link md-nav__container"> <a href=../projects/24fa/ class="md-nav__link "> <span class=md-ellipsis> Fall 2024 </span> </a> <label class="md-nav__link " for=__nav_2_4 id=__nav_2_4_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Fall 2024 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../24fa-neuroarchitecture/ class=md-nav__link> <span class=md-ellipsis> 24-Fa-Neuroarchitecture </span> </a> </li> <li class=md-nav__item> <a href=../24fa-mponc/ class=md-nav__link> <span class=md-ellipsis> 24-Fa-MPONC </span> </a> </li> <li class=md-nav__item> <a href=../24fa-energyinbuildings-com/ class=md-nav__link> <span class=md-ellipsis> 24-Fa-Energy-Com </span> </a> </li> <li class=md-nav__item> <a href=../24fa-energyinbuildings-res/ class=md-nav__link> <span class=md-ellipsis> 24-Fa-Energy-Res </span> </a> </li> <li class=md-nav__item> <a href=../24fa-microclimate-lstm-kriging/ class=md-nav__link> <span class=md-ellipsis> 24-Fa-Microclimate-LSTM-Kriging </span> </a> </li> <li class=md-nav__item> <a href=../24fa-microclimate-umcf/ class=md-nav__link> <span class=md-ellipsis> 24-Fa-Microclimate-UMCF </span> </a> </li> <li class=md-nav__item> <a href=../24fa-mobility-pei/ class=md-nav__link> <span class=md-ellipsis> 24-Fa-Mobility-PEI </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_5> <div class="md-nav__link md-nav__container"> <a href=../projects/24sp/ class="md-nav__link "> <span class=md-ellipsis> Spring 2024 </span> </a> <label class="md-nav__link " for=__nav_2_5 id=__nav_2_5_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Spring 2024 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../24sp-energyinbuildings/ class=md-nav__link> <span class=md-ellipsis> 24-Sp-Energy </span> </a> </li> <li class=md-nav__item> <a href=../24sp-microclimate/ class=md-nav__link> <span class=md-ellipsis> 24-Sp-Microclimate </span> </a> </li> <li class=md-nav__item> <a href=../24sp-mobility-pei/ class=md-nav__link> <span class=md-ellipsis> 24-Sp-Mobility-PEI </span> </a> </li> <li class=md-nav__item> <a href=../24sp-mobility-seg/ class=md-nav__link> <span class=md-ellipsis> 24-Sp-Mobility-Seg </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../team/ class="md-nav__link "> <span class=md-ellipsis> Team </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Team </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../team/25-Fa/ class=md-nav__link> <span class=md-ellipsis> 25-Fall </span> </a> </li> <li class=md-nav__item> <a href=../team/25-Sp/ class=md-nav__link> <span class=md-ellipsis> 25-Spring </span> </a> </li> <li class=md-nav__item> <a href=../team/24-Fa/ class=md-nav__link> <span class=md-ellipsis> 24-Fall </span> </a> </li> <li class=md-nav__item> <a href=../team/24-Sp/ class=md-nav__link> <span class=md-ellipsis> 24-Spring </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../activities/ class="md-nav__link "> <span class=md-ellipsis> Activities </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Activities </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../activities/rush/ class=md-nav__link> <span class=md-ellipsis> VIP Rush </span> </a> </li> <li class=md-nav__item> <a href=../activities/outreach/ class=md-nav__link> <span class=md-ellipsis> Outreach </span> </a> </li> <li class=md-nav__item> <a href=../activities/dinners/ class=md-nav__link> <span class=md-ellipsis> Class Dinners </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#reference-paper class=md-nav__link> <span class=md-ellipsis> Reference paper </span> </a> </li> <li class=md-nav__item> <a href=#setup class=md-nav__link> <span class=md-ellipsis> Setup </span> </a> </li> <li class=md-nav__item> <a href=#abstract class=md-nav__link> <span class=md-ellipsis> Abstract </span> </a> </li> <li class=md-nav__item> <a href=#intro-and-description class=md-nav__link> <span class=md-ellipsis> Intro and Description </span> </a> </li> <li class=md-nav__item> <a href=#cost-function class=md-nav__link> <span class=md-ellipsis> Cost Function </span> </a> <nav class=md-nav aria-label="Cost Function"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#attractiveness-upkeep-amenity_access-beltline_factor class=md-nav__link> <span class=md-ellipsis> Attractiveness = upkeep × amenity_access × beltline_factor </span> </a> </li> <li class=md-nav__item> <a href=#spatial-smoothing-of-amenity-data class=md-nav__link> <span class=md-ellipsis> Spatial Smoothing of Amenity Data </span> </a> <nav class=md-nav aria-label="Spatial Smoothing of Amenity Data"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#implemented-amenities-weights-openstreetmap-labels class=md-nav__link> <span class=md-ellipsis> Implemented Amenities &amp; weights (OpenStreetMap labels): </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#community-score-local-morans-i class=md-nav__link> <span class=md-ellipsis> Community Score (Local Moran’s I) </span> </a> </li> <li class=md-nav__item> <a href=#weighting-amenity-access-vs-community class=md-nav__link> <span class=md-ellipsis> Weighting amenity access vs community (λ) </span> </a> </li> <li class=md-nav__item> <a href=#tigerline-geodatabases-shapefiles class=md-nav__link> <span class=md-ellipsis> TIGER/Line Geodatabases shapefiles: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#project-status class=md-nav__link> <span class=md-ellipsis> Project status </span> </a> <nav class=md-nav aria-label="Project status"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#outputs-configuration class=md-nav__link> <span class=md-ellipsis> Outputs &amp; configuration </span> </a> <nav class=md-nav aria-label="Outputs & configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gif class=md-nav__link> <span class=md-ellipsis> GIF </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#runtimes class=md-nav__link> <span class=md-ellipsis> Runtimes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#census-based-approach class=md-nav__link> <span class=md-ellipsis> Census-based approach </span> </a> </li> <li class=md-nav__item> <a href=#atlanta-beltline-in-our-simulation class=md-nav__link> <span class=md-ellipsis> Atlanta Beltline in our Simulation </span> </a> </li> <li class=md-nav__item> <a href=#adapting-the-model-to-other-cities class=md-nav__link> <span class=md-ellipsis> Adapting the Model to Other Cities </span> </a> </li> <li class=md-nav__item> <a href=#policy-scenarios-vertical-vs-horizontal-scaling class=md-nav__link> <span class=md-ellipsis> Policy Scenarios: Vertical vs Horizontal Scaling </span> </a> <nav class=md-nav aria-label="Policy Scenarios: Vertical vs Horizontal Scaling"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-vertical-scaling-decision-making-agent-learns-kappa class=md-nav__link> <span class=md-ellipsis> 1. Vertical Scaling — Decision-Making Agent learns \(\kappa\) </span> </a> <nav class=md-nav aria-label="1. Vertical Scaling — Decision-Making Agent learns \(\kappa\)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#effective-multiplier class=md-nav__link> <span class=md-ellipsis> Effective multiplier </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-horizontal-scaling-complete-beltline-from-day-0 class=md-nav__link> <span class=md-ellipsis> 2. Horizontal Scaling (complete BeltLine from day 0) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#strengths-and-weaknesses class=md-nav__link> <span class=md-ellipsis> Strengths and Weaknesses </span> </a> <nav class=md-nav aria-label="Strengths and Weaknesses"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#strengths class=md-nav__link> <span class=md-ellipsis> Strengths </span> </a> </li> <li class=md-nav__item> <a href=#weaknesses class=md-nav__link> <span class=md-ellipsis> Weaknesses </span> </a> </li> <li class=md-nav__item> <a href=#next-steps class=md-nav__link> <span class=md-ellipsis> Next Steps </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path aria-label=Navigation> <ol class=md-path__list> <li class=md-path__item> <a href=../projects/ class=md-path__link> <span class=md-ellipsis> Projects </span> </a> </li> <li class=md-path__item> <a href=../projects/25fa/ class=md-path__link> <span class=md-ellipsis> Fall 2025 </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <a href=https://github.com/VIP-SMUR/25Fa-MPONC/blob/dev/README.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg> </a> <a href=https://github.com/VIP-SMUR/25Fa-MPONC/raw/dev/README.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"></path></svg> </a> <h1 id=modeling-processes-of-neighborhood-change-mponc>Modeling Processes of Neighborhood Change (MPONC)</h1> <h2 id=reference-paper>Reference paper</h2> <div class="language-bibtex highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nc>@misc</span><span class=p>{</span><span class=nl>mori2024modelingprocessesneighborhoodchange</span><span class=p>,</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=w>      </span><span class=na>title</span><span class=p>=</span><span class=s>{Modeling Processes of Neighborhood Change}</span><span class=p>,</span><span class=w> </span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>      </span><span class=na>author</span><span class=p>=</span><span class=s>{J. Carlos Martínez Mori and Zhanzhan Zhao}</span><span class=p>,</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>      </span><span class=na>year</span><span class=p>=</span><span class=s>{2024}</span><span class=p>,</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>      </span><span class=na>eprint</span><span class=p>=</span><span class=s>{2401.03307}</span><span class=p>,</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>      </span><span class=na>archivePrefix</span><span class=p>=</span><span class=s>{arXiv}</span><span class=p>,</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=w>      </span><span class=na>primaryClass</span><span class=p>=</span><span class=s>{cs.MA}</span><span class=p>,</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=w>      </span><span class=na>url</span><span class=p>=</span><span class=s>{https://arxiv.org/abs/2401.03307}</span><span class=p>,</span><span class=w> </span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=p>}</span>
</span></code></pre></div> <h2 id=setup>Setup</h2> <div class="language-bash highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=nb>cd</span><span class=w> </span>25Sp-MPONC/modeling_processes_of_neighborhood_change_new
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>conda<span class=w> </span>create<span class=w> </span>-n<span class=w> </span>mponc<span class=w> </span><span class=nv>python</span><span class=o>=</span><span class=m>3</span>.10.16
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>conda<span class=w> </span>activate<span class=w> </span>mponc
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>pip<span class=w> </span>install<span class=w> </span>-r<span class=w> </span>requirements.txt
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>python<span class=w> </span>main.py
</span></code></pre></div> <h2 id=abstract>Abstract</h2> <blockquote> <p>This research project simulates the impact of the Atlanta Beltline on the surrounding neighborhoods using no-regret-dynamics game theory. The simulation models agent movement across census tracts within Atlanta, GA's Fulton and Dekalb counties, with agents seeking to move optimally (prioritizing real-life incentives) based on several census tract attributes.</p> </blockquote> <h2 id=intro-and-description>Intro and Description</h2> <p>This project is based on the reference paper created by Dr. Martinez and Dr. Zhao, which aims to address the following: </p> <ul> <li>How does the layout of transportation infrastructure affect the demographics of nearby neighborhoods? </li> <li>Does the creation of these infrastructure actually benefit everyone equally; is it fair? </li> <li>Can we predict the effects on surrounding communities before these structures are actually built? </li> </ul> <p>These questions are primarily motivated by the issue of gentrification, an issue prevalent in many major cities. We utilized concepts in game theory, more specifically no-regret dynamics, in order to simulate the effects of the Atlanta Beltline on gentrification. To summarize our approach with no-regret dynamics:</p> <ul> <li>People, or 'agents', repeatedly select census tracts for relocation, from an initially uniform probability distribution. Computed from the tract's attributes, a <strong>'cost'</strong> value is assigned to the taken action, and the agent negates this cost from the chosen tract's selection probability. </li> <li><em>'Cost' is a function of region affordability, upkeep, and attractiveness.</em> </li> <li>The higher the cost, the less likely an agent is to visit that census tract in the future. </li> <li>This process is repeated until the probability distribution of visting census tracts converges - an equilibrium is reached, and agents have successfully 'learned' the attractiveness of each tract. Further actions make negligible difference to the probability distribution. </li> <li>This semester, we have changed the way we compute simulation convergence by using the <em>maximum best-action regret</em> across all agents between two sliding windows of recent agent‑distributions: </li> </ul> <div class=arithmatex>\[ r = \frac{1}{T} \big(\sum_{t = 1}^{T} c_t(a_t) - \sum_{t = 1}^{T} c_t(a_t^*) \big) \]</div> <p>where <span class=arithmatex>\(c_t(a_t)\)</span> denotes the cost of action <span class=arithmatex>\(a_t\)</span> and <span class=arithmatex>\(a_t^*\)</span> is the optimal action in hindsight at timestep <span class=arithmatex>\(t\)</span>. If <span class=arithmatex>\(r&nbsp;≤&nbsp;\epsilon\)</span> (default = 0.01) the system is deemed converged and the run halts automatically. All thresholds are configurable in <code>config.py</code>. - For practical purposes, an upper limit of <span class=arithmatex>\(T = \frac{4 \ln{A}}{\epsilon^2}\)</span> timesteps is set for each simulation, where <span class=arithmatex>\(A\)</span> is the size of the action space. </p> <h2 id=cost-function>Cost Function</h2> <p>Every agent evaluates a tract with a cost defined as</p> <blockquote> <p><strong>cost = 1&nbsp;–&nbsp;(affordability&nbsp;×&nbsp;upkeep x attractiveness)</strong></p> </blockquote> <table> <thead> <tr> <th>Factor</th> <th>Scale</th> <th>Quick intuition</th> </tr> </thead> <tbody> <tr> <td><strong>Affordability</strong></td> <td>0 or 1</td> <td>1 if the tract still has room <em>or</em> the agent is selected from an income-weighted lottery when the tract is overpopulated; 0 otherwise.</td> </tr> <tr> <td><strong>Upkeep</strong></td> <td>0–1</td> <td>How “maintained” and inhabited the tract is, based on the fraction of its resident capacity currently filled.</td> </tr> <tr> <td><strong>Attractiveness</strong></td> <td>0–1</td> <td>How nice the tract is to live in, combining amenity access and community similarity (see sub-components below).</td> </tr> </tbody> </table> <h3 id=attractiveness-upkeep-amenity_access-beltline_factor>Attractiveness&nbsp;=&nbsp;upkeep&nbsp;×&nbsp;amenity_access&nbsp;×&nbsp;beltline_factor</h3> <table> <thead> <tr> <th>Sub‑component</th> <th>Range</th> <th>What it captures</th> </tr> </thead> <tbody> <tr> <td><strong>Amenity access</strong></td> <td>0–1</td> <td>Density of key POIs (restaurants, shops, transit stops, etc.), spatially smoothed over neighbouring tracts and modified by BeltLine factor β.</td> </tr> <tr> <td><strong>Community</strong></td> <td>0–1</td> <td>How well an agent’s income matches incomes in the surrounding tracts—closer ⇒ higher score.</td> </tr> <tr> <td><strong>BeltLine factor β</strong></td> <td>≥ 1</td> <td>Extra accessibility for tracts in the BeltLine catchment area: β = B (max boost) on the BeltLine, tapering linearly down to 1 at radius R, and staying 1 outside R.</td> </tr> </tbody> </table> <p>*&nbsp;Amenity list adapted from <strong><a href=https://vip-smur.github.io/24sp-mobility-seg/ >24Sp‑Mobility‑Seg</a></strong>; we omit several tags such as “shed”, “guardhouse”, “ferry_terminal”, “garages”, and “bridge”.</p> <h3 id=spatial-smoothing-of-amenity-data>Spatial Smoothing of Amenity Data</h3> <p>To ensure that the amenity component of a tract's Attractiveness score accurately reflects the <em>true</em> environment and facilitates realistic agent decision-making, we employ a spatial smoothing strategy. Direct raw counts from OpenStreetMap (OSM) frequently register zero amenities in certain census tracts. Allowing these zero values to persist would be misleading, as agents rarely perceive their neighborhood's amenities as strictly limited to their immediate tract boundary; instead, they consider nearby shops, parks, and transit.</p> <p>To counteract this data sparsity and noise, we use <strong>Queen contiguity weights</strong> to define the neighborhood structure. This definition is inclusive, considering two tracts to be neighbors if they share any common border <em>or</em> a single corner point. Leveraging the PySAL library, we then compute a <strong>spatial lag</strong> on the raw amenity densities. Conceptually, this process calculates a weighted average for each tract's amenity score, blending its own raw density with the densities of all its Queen-contiguous neighbors. This produces a smoothed, more plausible amenity distribution across the region, which is essential for governing agents' relocation decisions and ultimately modeling gentrification dynamics accurately.</p> <h4 id=implemented-amenities-weights-openstreetmap-labels>Implemented Amenities &amp; weights (OpenStreetMap labels):</h4> <p></p><div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>AMENITY_TAGS</span> <span class=o>=</span> <span class=p>{</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>      <span class=s1>'amenity'</span><span class=p>:</span> <span class=p>(</span><span class=s2>"bus_station|cafe|college|fast_food|food_court|fuel|library|restaurant|train_station|university|parking|school|hospital"</span><span class=p>,</span> <span class=mi>3</span><span class=p>),</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>      <span class=s1>'shop'</span><span class=p>:</span> <span class=p>(</span><span class=s2>"supermarket|food|general|department_store|mall|wholesale"</span><span class=p>,</span> <span class=mi>3</span><span class=p>),</span>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>      <span class=s1>'landuse'</span><span class=p>:</span> <span class=p>(</span><span class=s2>"residential|industrial|commercial|retail"</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=p>}</span>
</span></code></pre></div> * We operationalize <strong>β</strong> by giving tracts within <strong>800 m</strong> of the BeltLine a <strong>+20 %</strong> boost to their Attractiveness score (β = 1.20/1.20); the boost then tapers linearly to <strong>+10 %</strong> at <strong>1.6 km</strong>, and falls to β = 1.00/1.20 beyond that distance. This <strong>β</strong> is applied as an exponent: each tract’s amenity density is raised to the power <span class=arithmatex>\(1/β_c\)</span>. This provides a stronger <em>relative</em> boost to low-amenity tracts and milder gains for amenity-rich tracts, approximating the diminishing-returns effect of BeltLine’s observed proximity on nearby housing prices.<p></p> <h3 id=community-score-local-morans-i>Community Score (Local Moran’s I)</h3> <p>Due to the difficulties with Moran's, we are using a simplified implementation of the Community Score calculation. Community ties <span class=arithmatex>\(<span class=arithmatex>\((Community_a(c))\)</span>\)</span> model socioeconomic affinity by measuring how closely a specific agent's endowment matches the endowments of nearby agents. For each agent, we compute a community endowment defined as the mean income of the tract the agent currently occupies along with all tracts adjacent to it. The model uses PySAL to calculate the average income of the tract and its neighbors for whichever year is selected.</p> <p>The community endowment is computed as:</p> <div class=arithmatex>\[ \bar{E}_c = \frac{1}{N_c} \sum_{i \in \{c \cup \text{Neighbors}(c)\}} E_i \]</div> <p>The agent’s community-tie value is then calculated as the difference between the agent’s own endowment and this community endowment:</p> <div class=arithmatex>\[ \mathrm{Community}_a(c) = E_a - \bar{E}_c \]</div> <p>Agents whose incomes closely match the incomes of their surrounding tracts receive stronger community-tie scores, while those whose incomes differ substantially receive weaker ties. A closer match ⇒ value near 1 ⇒ lower cost.</p> <p>For a deep explanation of how Moran's works, why it isn't implemented into the paper yet, and the next steps, please see the Spatial Autocorrelation portion of the readme.</p> <h3 id=weighting-amenity-access-vs-community>Weighting amenity access vs community (λ)</h3> <p>A tunable parameter <strong>λ&nbsp;∈&nbsp;[0, 1]</strong> lets you emphasize either amenity access (high λ) or community match (low λ).<br> Internally we rewrite<br> </p><div class="language-text highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>cost = 1 - [[Affordability] × [Upkeep x (λ × AmenityAccess)] × [(1-λ) × Community]]
</span></code></pre></div><p></p> <h3 id=tigerline-geodatabases-shapefiles>TIGER/Line Geodatabases shapefiles:</h3> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=./Figures/ZIP_URLs.png data-desc-position=bottom><img src=./Figures/ZIP_URLs.png alt="Alt text" max-width=600></a></p> <h2 id=project-status>Project status</h2> <h3 id=outputs-configuration>Outputs &amp; configuration</h3> <p>Our code outputs a GIF to visualize agent behavior over time. Each circle represents the centroid of a census tract - green signifying those in the Atlanta Beltline - and the encircled number is the agent population. Our code also outputs a CSV file containing all the simulated data at every individual timestep.</p> <ul> <li><em>Data contained in CSV's: Census tract name, agent population, raw average income, average income reported by census, normalized average incomes, and amenity density.</em></li> <li><em>Note: 'Timestep' refers to a single instance agent action (relocation); 20,000 timesteps mean the agents relocate a total of 20,000 times during the simulation.</em></li> </ul> <h4 id=gif>GIF</h4> <p>This GIF shows the behavior of 1,000 agents up to 20,000 timesteps, frames being captured every 400 timesteps. Rho=1, alpha=0.25. <a class=glightbox data-type=image data-width=auto data-height=auto href=./Figures/SimulationGIF2025.gif data-desc-position=bottom><img src=./Figures/SimulationGIF2025.gif alt="Alt text" max-width=600></a></p> <h3 id=runtimes>Runtimes</h3> <blockquote> <p>(1000 agents, 349 census tracts) - Simulation: 3 min * Graph, amenities, and centroids are cached after first build</p> </blockquote> <h2 id=census-based-approach>Census-based approach</h2> <p>Our project utilizes US Census data in that: - The geographical regions our agents inhabit correspond directly to US census tracts (can correspond to any other census-defined geographic unit, i.e. zip codes, housing districts, and school districts). - Each 'agent' is assigned a 'wealth' value in our simulation. We create this distribution of wealth using Census data (population &amp; median incomes), to represent real-world demographics.</p> <h2 id=atlanta-beltline-in-our-simulation>Atlanta Beltline in our Simulation</h2> <p>We automate the process of labelling certain regions as 'within the Atlanta Beltline's catchment zone' by using commuting paths from OpenStreetMap that correspond to the Atlanta Beltline - namely, a bike trail and a railway. To experiment with a different beltline, such as a beltline that spanned across Atlanta horizontally, or simply expanded north by x miles, we would acquire the OpenStreetMap ID's of existing paths (bike trails, walking paths, roads, etc.) corresponding to our desired Beltline, and paste these into <strong>config.py</strong>. Alternatively, we can create a such path ourselves in OpenStreetMap. Then, any region containing segments of these trails would automatically receive a "Beltline Score" which boosts its perceived attractiveness by agents. </p> <p>In <strong>config.py</strong> - bike trail and railroad OpenStreetMap ID's for the beltline are as follows:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=sd>""" Beltline 'relation' IDs from Open Street Map """</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=n>RELATION_IDS</span> <span class=o>=</span> <span class=p>[</span><span class=mi>8408433</span><span class=p>,</span> <span class=mi>13048389</span><span class=p>]</span>
</span></code></pre></div> <table> <thead> <tr> <th style="text-align: center;">Bike Trail</th> <th style="text-align: center;">Railroad</th> </tr> </thead> <tbody> <tr> <td style="text-align: center;"><a class=glightbox data-type=image data-width=auto data-height=auto href=./Figures/BeltlineBikeTrail.png data-desc-position=bottom><img src=./Figures/BeltlineBikeTrail.png width=300></a></td> <td style="text-align: center;"><a class=glightbox data-type=image data-width=auto data-height=auto href=./Figures/BeltlineRailroad.png data-desc-position=bottom><img src=./Figures/BeltlineRailroad.png width=300></a></td> </tr> </tbody> </table> <p>Compare with Atlanta Beltline geography:</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=./Figures/AtlantaBeltlineVisual.jpg data-desc-position=bottom><img src=./Figures/AtlantaBeltlineVisual.jpg width=250></a></p> <h2 id=adapting-the-model-to-other-cities>Adapting the Model to Other Cities</h2> <p>Although Atlanta serves as our case study, every pipeline stage—census shapefiles, OSM‑derived amenities, cost parameters, and even the BeltLine decision‑agent—can be swapped for a different region:</p> <ol> <li> <p><strong>Geometry &amp; Demographics</strong><br> • Replace the Fulton/DeKalb TIGER/Line shapefiles with those of your target city.<br> • Point the <code>MEDIAN_INCOME_URL</code> and <code>POP_URL</code> in <code>config.py</code> to that city’s American Community Survey "ACS" tables.</p> </li> <li> <p><strong>Transit‑Ring Definition</strong><br> • Identify (or sketch in OSM) the planned loop / BRT corridor / rail spur you want to study, then list its OSM relation IDs in <code>config.py</code>.<br> • The same β‑taper and DecisionAgent logic will assign accessibility boosts and density bonuses around the new corridor.</p> </li> <li> <p><strong>Policy Levers</strong><br> • Tweak <code>RHO_SCALAR</code> to explore how strong the up‑zoning response should be for the above transit ring.</p> </li> </ol> <p>Because the simulation is purely data‑driven, you can rapidly prototype “what‑if” BeltLine analogues for <strong>anywhere with open census and OSM data while measuring potential community shifts/gentrification before shovels hit the ground.</strong> Example: <a class=glightbox data-type=image data-width=auto data-height=auto href=./Figures/OldZipURL.png data-desc-position=bottom><img src=./Figures/OldZipURL.png alt="Alt text" max-width=600></a> * By changing the above URL, we get the following:</p> <p><a class=glightbox data-type=image data-width=auto data-height=auto href=./Figures/AtlantaBeltlineCloseupGraph.png data-desc-position=bottom><img src=./Figures/AtlantaBeltlineCloseupGraph.png alt="Alt text" width=250></a></p> <h2 id=policy-scenarios-vertical-vs-horizontal-scaling>Policy Scenarios: Vertical vs Horizontal Scaling</h2> <p>The simulation now supports two high-level policy experiments:</p> <h3 id=1-vertical-scaling-decision-making-agent-learns-kappa>1. Vertical Scaling — Decision-Making Agent learns <span class=arithmatex>\(\kappa\)</span></h3> <p>A dedicated <code>DecisionAgent</code> treats <strong>how aggressively to expand housing capacity near the Beltline</strong> as a no-regret learning problem:</p> <ul> <li><strong>Action space</strong>: <span class=arithmatex>\( \kappa \in \{0.00, 0.01, \dots, 1.00\} \)</span></li> </ul> <p>sampled each timestep by multiplicative‑weights&nbsp;(no‑regret-dynamics).</p> <ul> <li><strong>Base capacity curve</strong>:<br></li> </ul> <div class="language-text highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>U_c = 1 + \frac{\texttt{beltline\_score}_c - \texttt{BL\_LOW}}{\texttt{BL\_HIGH} - \texttt{BL\_LOW}} \times \bigl(\texttt{RHO\_SCALAR}_{max} - 1\bigr) 
</span></code></pre></div> <h4 id=effective-multiplier>Effective multiplier</h4> <div class="language-text highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>\rho_c^{\text{new}}
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>  = \rho_c^{\text{base}}
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>    \times
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>    \left[1 + \kappa\,M_c\right]
</span></code></pre></div> <p>where <span class=arithmatex>\(M_c\)</span> is the <strong>maximum permissible percent increase</strong> for tract <span class=arithmatex>\(c\)</span> based on distance to the Beltline.</p> <p>Two alternative utility metrics guide learning:</p> <table> <thead> <tr> <th><code>UTILITY_METRIC</code></th> <th>Algorithm maximises</th> <th>Real‑world analogy</th> </tr> </thead> <tbody> <tr> <td><code>0</code> <em>(default)</em></td> <td><strong>average utility</strong> (mean&nbsp;well‑being across all agents)</td> <td>“Greatest good for the greatest number.”</td> </tr> <tr> <td><code>1</code></td> <td><strong>minimum utility</strong> (well‑being of the worst‑off agent)</td> <td>Rawlsian / max‑min fairness.</td> </tr> </tbody> </table> <p>The DecisionAgent reinforces actions that raise the chosen utility, gradually converging to an ideal <em>m</em> for the current policy goal. </p> <p>These “concrete zoning‑bonus percentages and distance bands” are the literal numbers (+20 %, +10 %, 800 m, 1600 m) encoded in <code>DecisionAgent.py</code>. Feel free to edit them in <code>config.py</code>.</p> <h3 id=2-horizontal-scaling-complete-beltline-from-day-0>2. Horizontal Scaling&nbsp;(complete BeltLine from day 0)</h3> <p>All census tracts whose centroids fall inside the Beltline’s catchment radius begin with <strong>β_c &gt; 1</strong>, following the same taper function used in the baseline model.<br> Unlike vertical scaling, <strong>capacities do not change</strong>—only the geography of Beltline-induced accessibility (amenity-attractiveness) changes.</p> <p>This models a scenario where the entire Beltline loop has been completed.</p> <h2 id=strengths-and-weaknesses>Strengths and Weaknesses</h2> <h3 id=strengths>Strengths</h3> <p>Our approach is very modularized. For instance, our code can easily be ran on other regions, with customizable 'Beltlines' and parameters. Furthermore, Our approach is backed by established human behavior approaches (no-regret dynamics) rather than pre-defined, non-adaptive agent behavior. We are also able to produce dynamic visuals (GIFs).</p> <h3 id=weaknesses>Weaknesses</h3> <p>Our simulation also assumes that there is no immigration/emigration in Atlanta, as we set a fixed number of agents which are able to exit, and hence re-enter, our defined area. We also limit transportation choices to cars and public transportation, despite other modes of transport being popular (walking or biking). Additionally, our runtimes may be relatively long due to the computationally expensive nature of the simulation (several minutes). Ideally, our simulation would be ran in just seconds.</p> <h3 id=next-steps>Next Steps</h3> <p>We hope to improve the readability of our GIF's, improve the runtime of the simulation, and include additional visualizations of our results to better communicate our analysis during discussion. We also hope to run SOBOL sensitivity nalysis of our parameters once more.</p> <h1 id=spatial-autocorrelation>Spatial Autocorrelation</h1> <p>This section serves as an explanation for the conceptual and applied framework for spatial autocorrelation in the MPONC simulation. I will begin by explaining the concepts necessary to understand spatial autocorrelation, specifically for Local Moran's I. It's important to understand that spatial autocorrelation is used to calculate the community score and if you are unsure what community score represents or the justification for it, then see the general readME. This readme is speficially for community score's implementation. </p> <hr> <h2 id=the-math>The Math</h2> <h3 id=local-morans-i>Local Moran's I</h3> <p>Spatial Autocorrelation is a geographic concept for finding clusters of similarity or dissimilarity in geographic data. The most common formula is <strong>Local Moran's I</strong>:</p> <div class=arithmatex>\[ I_i = \frac{(x_i - \bar{x})}{m_2} \sum_{j=1}^{n} w_{ij} (x_j - \bar{x}) \]</div> <p>Where:</p> <ul> <li><span class=arithmatex>\(\( x_i \)\)</span>: value of the variable at location <em>i</em> (agent endowments)</li> <li><span class=arithmatex>\(\( \bar{x} \)\)</span>: mean of all <span class=arithmatex>\( x \)</span> values (average endowments of all agents)</li> <li><span class=arithmatex>\(\( w_{ij} \)\)</span>: spatial weight between locations <em>i</em> and <em>j</em> (morans weights)</li> <li><span class=arithmatex>\(\( n \)\)</span>: total number of observations</li> <li><span class=arithmatex>\(\( m_2 = \frac{1}{n} \sum_{i=1}^{n} (x_i - \bar{x})^2 \)\)</span>: variance normalization term</li> </ul> <p><span class=arithmatex>\(<span class=arithmatex>\(I_i\)</span>\)</span> represents the value of morans for the specific agent. In our case, we can obtain the "community score" by calculating the local moran's value for that agent and normalizing this value to be between 0 and 1. While this formula is how Moran's I runs, our simulation uses esda.local_moran, instead of manually implementing the math. In order to do this, we need to form our own weights value and way of tracking endowments for each agent to give to esda. <strong>Importantly, the weights matrix is per census tract and represents the weights between census tracts, while agent endowments are per agent.</strong></p> <h3 id=neighbors>Neighbors</h3> <p>In the pure mathematical form of Local Moran's I, every node is compared with every other node in the set. However, this is computationally expensive and also causes odd behavior around edges (see Appendix A). The common alternate approach is to only consider neighbors. So if a census tract is touching 6 other census tracts, then that tract has 6 neighbors to compare with and effectively only those 6 neighbors impact the agent's community score. Another common approach is to use decay over the entire set of nodes. So every node is a “neighbor,” but the Moran’s weights reflect that closer neighbors have a stronger impact on the community of a node.</p> <p>For our simulation we use a K-nearest neighbors approach, which sets a fixed set of neighbors - that we can configure for each simulation - and then uses decay. So if we set neighbors to 20, then the closest 20 nodes are neighbors with the closer ones counting more. We chose this because it’s much faster than a full decay (with full decay you have to iterate over 500 nodes for every moran’s calculation for each node), but reflects that people’s perception of their neighborhood extends further than 10-20 minutes away from them. The decay should remain high.</p> <h3 id=normalization>Normalization</h3> <p>Normalization is important for local morans because the raw values for morans can vary without range. They often are negative and they are not constrained to any range. Community score, however, does need to be constrained from 0 to 1. Therefore, we need a way to constrain our morans values to between 0 and 1. </p> <p>Our original approach was to use z-score-to-cdf. This means we first take the morans values we calculate and perform a z-score normalization (this is standard in statistics) and then map those values to [0,1] using CDF which conceptually is like saying “this is the 90<sup>th</sup> percentile value in our simulation so the value is really 0.9”. The issue with this was that it causes more extreme values if the moran’s values have a low standard deviation. </p> <p>The new approach is to use a direct mapping after z-score. The equation for that is simply:</p> <div class=arithmatex>\[ p_i = \frac{z_i - \min(z)}{\max(z) - \min(z)} \]</div> <p><strong>IMPORTANT, this is currently not reflected in the main branch of the code. We’ll need to update this if we go back to moran’s</strong></p> <h2 id=the-simulation>The Simulation</h2> <h2 id=morans_analysispy>Morans_analysis.py</h2> <p>Let’s go through the code one section at a time to review the design principles. </p><div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>def</span><span class=w> </span><span class=nf>_library_spatial_autocorrelation</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>city</span><span class=p>):</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>    <span class=c1># Prefer tract-level Moran's weights stored on the city (centroid-level).</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>    <span class=c1># If not present, build weights from cached distances below.</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>    <span class=n>tract_W_mat</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>city</span><span class=p>,</span> <span class=s2>"morans_weights"</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>    <span class=n>agent_endowments</span> <span class=o>=</span> <span class=n>city</span><span class=o>.</span><span class=n>agt_dows</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>    <span class=n>agent_positions</span> <span class=o>=</span> <span class=n>city</span><span class=o>.</span><span class=n>agent_positions</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>    <span class=c1># If city provides a tract-level numpy matrix, convert to libpysal W</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tract_W_mat</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>        <span class=k>if</span> <span class=ow>not</span> <span class=n>np</span><span class=o>.</span><span class=n>isfinite</span><span class=p>(</span><span class=n>tract_W_mat</span><span class=p>)</span><span class=o>.</span><span class=n>all</span><span class=p>():</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>            <span class=n>nan_positions</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=o>~</span><span class=n>np</span><span class=o>.</span><span class=n>isfinite</span><span class=p>(</span><span class=n>tract_W_mat</span><span class=p>))</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Found non-finite values in tract-level weights matrix at positions: </span><span class=si>{</span><span class=n>nan_positions</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>        <span class=c1># build weights_dict expected by libpysal.W</span>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>        <span class=n>weights_dict</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a>        <span class=n>n_nodes</span> <span class=o>=</span> <span class=n>tract_W_mat</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n_nodes</span><span class=p>):</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a>            <span class=n>row</span> <span class=o>=</span> <span class=n>tract_W_mat</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a>            <span class=n>neigh</span> <span class=o>=</span> <span class=p>{</span><span class=n>j</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=n>j</span><span class=p>])</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n_nodes</span><span class=p>)</span> <span class=k>if</span> <span class=n>row</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>}</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a>            <span class=n>weights_dict</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>neigh</span>
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a>        <span class=n>w_obj</span> <span class=o>=</span> <span class=n>W</span><span class=p>(</span><span class=n>weights_dict</span><span class=p>)</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a>        <span class=n>w_obj</span><span class=o>.</span><span class=n>transform</span> <span class=o>=</span> <span class=s2>"r"</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a>        <span class=n>w</span> <span class=o>=</span> <span class=n>w_obj</span>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a>        <span class=n>w</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a>
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a>    <span class=k>if</span> <span class=n>w</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>cached_distances</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-7-28><a id=__codelineno-7-28 name=__codelineno-7-28 href=#__codelineno-7-28></a>            <span class=bp>self</span><span class=o>.</span><span class=n>cached_distances</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s2>"neighbors.npy"</span><span class=p>,</span> <span class=n>mmap_mode</span><span class=o>=</span><span class=s2>"r"</span><span class=p>)</span>
</span><span id=__span-7-29><a id=__codelineno-7-29 name=__codelineno-7-29 href=#__codelineno-7-29></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"[MoransAnalyzer] Loaded cached centroid distances for </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>cached_distances</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2> centroids"</span><span class=p>)</span>
</span><span id=__span-7-30><a id=__codelineno-7-30 name=__codelineno-7-30 href=#__codelineno-7-30></a>
</span><span id=__span-7-31><a id=__codelineno-7-31 name=__codelineno-7-31 href=#__codelineno-7-31></a>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>cached_KNN</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-7-32><a id=__codelineno-7-32 name=__codelineno-7-32 href=#__codelineno-7-32></a>            <span class=bp>self</span><span class=o>.</span><span class=n>cached_KNN</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>cached_distances</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>:</span><span class=n>SPATIAL_K_NEIGHBORS</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
</span><span id=__span-7-33><a id=__codelineno-7-33 name=__codelineno-7-33 href=#__codelineno-7-33></a>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>"[MoransAnalyzer] Cached KNN neighbors with k=</span><span class=si>{</span><span class=n>SPATIAL_K_NEIGHBORS</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>
</span><span id=__span-7-34><a id=__codelineno-7-34 name=__codelineno-7-34 href=#__codelineno-7-34></a>
</span><span id=__span-7-35><a id=__codelineno-7-35 name=__codelineno-7-35 href=#__codelineno-7-35></a>        <span class=k>if</span> <span class=nb>getattr</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=s2>"cached_W"</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-7-36><a id=__codelineno-7-36 name=__codelineno-7-36 href=#__codelineno-7-36></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_ensure_cached_W_from_distances</span><span class=p>()</span>
</span><span id=__span-7-37><a id=__codelineno-7-37 name=__codelineno-7-37 href=#__codelineno-7-37></a>        <span class=c1># --- Step 3: Align agent_endowments with weight matrix ---</span>
</span><span id=__span-7-38><a id=__codelineno-7-38 name=__codelineno-7-38 href=#__codelineno-7-38></a>        <span class=n>w</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>cached_W</span>
</span></code></pre></div> Okay, let's review this. The library call accepts the entire city, which is not the most efficient, but otherwise we would need 4 or 5 input parameters from the city, so this is simpler. The code itself ensures that a spatial weights matrix (W) exists, which is essential for computing Local Moran’s I.<p></p> <p>Spatial weights define which regions (or agents) are considered neighbors and how strongly they influence each other. The code first checks whether these weights already exist (as a tract-level NumPy matrix on the city object). If not, it dynamically builds them from cached distance data.</p> <ol> <li>Using Precomputed Tract Weights</li> <li>If the city object already provides a tract-level distance matrix (morans_weights):</li> <li>The code verifies that all values are finite (no NaNs or infinities).</li> <li>It converts the NumPy distance matrix into a Libpysal W object, the standard spatial weights format used by the PySAL ecosystem.</li> <li>Each tract’s row is converted into a dictionary mapping neighbor indices → weight values.</li> <li>Finally, the matrix is row-standardized (w_obj.transform = "r"), so each row sums to 1.</li> <li> <p>This path is used when a ready-made Moran’s weights matrix is already available (for example, from prior preprocessing or caching).</p> </li> <li> <p>Building Weights from Cached Distances</p> </li> <li> <p>If the city object doesn’t have a precomputed weights matrix (w is None), the method builds one on the fly:</p> </li> <li>It loads a precomputed centroid distance matrix from neighbors.npy, which stores pairwise distances between tracts.</li> <li>It constructs a k-nearest-neighbor (KNN) structure (self.cached_KNN), where each tract is connected to its SPATIAL_K_NEIGHBORS closest neighbors.</li> <li>If a cached Libpysal W object (self.cached_W) doesn’t exist yet, it calls _ensure_cached_W_from_distances() to create it.</li> <li>This helper computes inverse-distance weights, so closer tracts have stronger influence.</li> <li>The resulting matrix is also row-standardized.</li> </ol> <p>After these steps, the method guarantees that a valid Libpysal W object (w) exists — ready for use in the Local Moran’s I calculation that follows.</p> <p></p><div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=n>values</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>agent_endowments</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>float</span><span class=p>)</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>        <span class=n>n_agents</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>values</span><span class=p>)</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>        <span class=n>n_nodes</span> <span class=o>=</span> <span class=n>w</span><span class=o>.</span><span class=n>n</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>        <span class=c1># Adjust sizes</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>        <span class=k>if</span> <span class=n>n_agents</span> <span class=o>&lt;</span> <span class=n>n_nodes</span><span class=p>:</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>            <span class=c1># pad missing nodes with mean value (not NaN to avoid broadcasting)</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>            <span class=n>mean_val</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>values</span><span class=p>)</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>            <span class=n>padded</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>full</span><span class=p>(</span><span class=n>n_nodes</span><span class=p>,</span> <span class=n>mean_val</span><span class=p>)</span>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>            <span class=n>padded</span><span class=p>[:</span><span class=n>n_agents</span><span class=p>]</span> <span class=o>=</span> <span class=n>values</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>            <span class=n>values</span> <span class=o>=</span> <span class=n>padded</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>        <span class=k>elif</span> <span class=n>n_agents</span> <span class=o>&gt;</span> <span class=n>n_nodes</span><span class=p>:</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>            <span class=c1># truncate if too many agents: average agents into tract-level values.</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>            <span class=c1># Use the simulation's canonical number of tracts (centroids) rather than</span>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a>            <span class=c1># deriving it from agent_positions, which can change as agents move.</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a>            <span class=n>num_tracts</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=nb>getattr</span><span class=p>(</span><span class=n>city</span><span class=p>,</span> <span class=s2>"centroids"</span><span class=p>,</span> <span class=p>[]))</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a>            <span class=n>values</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_average_agents_by_tract</span><span class=p>(</span><span class=n>agent_endowments</span><span class=p>,</span> <span class=n>agent_positions</span><span class=p>,</span> <span class=n>num_tracts</span><span class=o>=</span><span class=n>num_tracts</span><span class=p>)</span>
</span><span id=__span-8-18><a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a>
</span><span id=__span-8-19><a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a>        <span class=c1># Replace NaNs with mean for stability</span>
</span><span id=__span-8-20><a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a>        <span class=n>mean_val</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nanmean</span><span class=p>(</span><span class=n>values</span><span class=p>)</span>
</span><span id=__span-8-21><a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a>        <span class=n>values</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan_to_num</span><span class=p>(</span><span class=n>values</span><span class=p>,</span> <span class=n>nan</span><span class=o>=</span><span class=n>mean_val</span><span class=p>)</span>
</span><span id=__span-8-22><a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a>
</span><span id=__span-8-23><a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>values</span><span class=p>)</span> <span class=o>!=</span> <span class=n>w</span><span class=o>.</span><span class=n>n</span><span class=p>:</span>
</span><span id=__span-8-24><a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>"Length mismatch: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>values</span><span class=p>)</span><span class=si>}</span><span class=s2> values vs </span><span class=si>{</span><span class=n>w</span><span class=o>.</span><span class=n>n</span><span class=si>}</span><span class=s2> weights"</span><span class=p>)</span>
</span></code></pre></div> To ensure the endowment vector and the spatial weights matrix are compatible in size, the function performs the following adjustments:<p></p> <p>Case 1: Fewer agents than spatial nodes If the number of agents (n_agents) is less than the number of spatial nodes (n_nodes), the missing nodes are padded with the mean endowment value.</p> <p>Mathematically:</p> <div class=arithmatex>\[ values[i] = \begin{cases} agent\_endowment[i], &amp; i &lt; n\_{\text{agents}} \\ \bar{x}, &amp; i \ge n\_{\text{agents}} \end{cases} \]</div> <p>where x̄ is the mean of all agent endowments. This ensures every spatial node has a corresponding endowment value.</p> <p>Case 2: More agents than spatial nodes If the number of agents (n_agents) exceeds the number of nodes (n_nodes), agents are aggregated by tract, and the mean endowment per tract is used.</p> <p>Mathematically:</p> <div class=arithmatex>\[ tract\_value[j] = \frac{1}{|A_j|} \sum_{i \in A_j} endowment\_i \]</div> <p>where Aⱼ is the set of agents that belong to tract j. Each tract’s endowment value becomes the average of all agents in that tract.</p> <p>Case 3: Handle missing or invalid values Any missing (NaN) or undefined values are replaced by the overall mean value x̄ to ensure numerical stability and prevent errors during computation.</p> <p>Final check After these adjustments, the endowment vector and the spatial weights matrix always have the same length:</p> <div class=arithmatex>\[ |values| = n_nodes = |W| \]</div> <p>This guarantees proper alignment between endowments and spatial weights when computing Moran’s I.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># I need to check what 0 permutations actually means</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>        <span class=k>if</span> <span class=n>USE_SIMPLIFIED_COMMUNITY_SCORE</span> <span class=o>==</span> <span class=s1>'morans'</span><span class=p>:</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>            <span class=n>lisa</span> <span class=o>=</span> <span class=n>Moran_Local</span><span class=p>(</span><span class=n>values</span><span class=p>,</span> <span class=n>w</span><span class=p>,</span> <span class=n>permutations</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>            <span class=n>results</span> <span class=o>=</span>  <span class=n>lisa</span><span class=o>.</span><span class=n>Is</span>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>        <span class=k>elif</span> <span class=n>USE_SIMPLIFIED_COMMUNITY_SCORE</span> <span class=o>==</span> <span class=s1>'gearys'</span><span class=p>:</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>            <span class=n>local_geary</span> <span class=o>=</span> <span class=n>Geary_Local</span><span class=p>(</span><span class=n>w</span><span class=p>,</span> <span class=n>permutations</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>            <span class=n>local_geary</span> <span class=o>=</span> <span class=n>local_geary</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>values</span><span class=p>)</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>            <span class=n>results</span> <span class=o>=</span> <span class=n>local_geary</span><span class=o>.</span><span class=n>localG</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>            <span class=nb>print</span><span class=p>(</span><span class=s2>"invalid use_simplified_community_score value"</span><span class=p>)</span>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a>            <span class=k>return</span> <span class=kc>None</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a>
</span><span id=__span-9-13><a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a>        <span class=c1>#Convert to NumPy array for consistency</span>
</span><span id=__span-9-14><a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a>        <span class=n>results</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>results</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>float</span><span class=p>)</span>
</span><span id=__span-9-15><a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a>
</span><span id=__span-9-16><a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a>        <span class=c1># Convert tract-level results to CDF-normalized scores</span>
</span><span id=__span-9-17><a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a>        <span class=n>tract_scores</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>zscore_to_cdf</span><span class=p>(</span><span class=n>results</span><span class=p>)</span>  <span class=c1># shape (C,)</span>
</span><span id=__span-9-18><a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a>
</span><span id=__span-9-19><a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a>        <span class=c1># Map tract-level scores to per-agent scores so callers receive an (N,) array</span>
</span><span id=__span-9-20><a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a>        <span class=c1># (every agent in the same tract receives the same tract score).</span>
</span><span id=__span-9-21><a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a>        <span class=n>agent_positions</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>asarray</span><span class=p>(</span><span class=n>agent_positions</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>intp</span><span class=p>)</span>
</span><span id=__span-9-22><a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a>        <span class=k>if</span> <span class=n>agent_positions</span><span class=o>.</span><span class=n>size</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-9-23><a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a>            <span class=c1># no agents present -&gt; return empty array</span>
</span><span id=__span-9-24><a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a>            <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>asarray</span><span class=p>([],</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>float</span><span class=p>)</span>
</span><span id=__span-9-25><a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a>
</span><span id=__span-9-26><a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a>        <span class=c1># Direct mapping: assume agent_positions are valid tract indices.</span>
</span><span id=__span-9-27><a id=__codelineno-9-27 name=__codelineno-9-27 href=#__codelineno-9-27></a>        <span class=n>agent_scores</span> <span class=o>=</span> <span class=n>tract_scores</span><span class=p>[</span><span class=n>agent_positions</span><span class=p>]</span>
</span><span id=__span-9-28><a id=__codelineno-9-28 name=__codelineno-9-28 href=#__codelineno-9-28></a>        <span class=k>return</span> <span class=n>agent_scores</span>
</span></code></pre></div> <p>This is where the actual morans/gearys happens. Here we determine which Spatial Autocorrelation algorithm to use and then run that using the library. The '0 permutations' means the library only runs once. You can set a higher amount of permutations and then calculate means, medians, standard deviations, etc... but we choose not to do this because every permutation slows the simulation down. Then we make sure the data is in the right format and uses the correct normalization. Then when we 'map tract-level scores to per-agent scores', this ensures that the agents recieve the correct score for their track.</p> <p>The issue with this is that all agents in the tract will recieve the same morans score. The library runs on a node basis not an agent basis, which means we have to manipulate the data to get the results we want. There's a few potential ways to convert tract-level morans to agent-level morans. Potentially, you can add a faux tract with the same distances as the real tract the agent is and then set the endowment of the faux tract to the endowment of the agent. The issue with this is it requires a loop for every agent which means if there's N agents, then you need to run the library-morans N times, which is far too slow to be useful.Another way is to not use the library and instead do the calculations manually, which leaves more error for potential coding issues and will also be slower than the regular library due to the library's optimizations.</p> <h2 id=presentation>Presentation</h2> <p><a href="https://www.youtube.com/watch?v=V6XC36CP5ew" target=_blank rel="noopener noreferrer"> <img src=https://img.youtube.com/vi/V6XC36CP5ew/maxresdefault.jpg width=480 class=off-glb> </a></p> <h2 id=team>Team</h2> <table> <thead> <tr> <th>Name</th> <th>Seniority</th> <th>Major</th> <th>School</th> <th># Semesters</th> <th>GitHub Handle</th> </tr> </thead> <tbody> <tr> <td>Matthew Lim</td> <td>Junior</td> <td>Computer Science</td> <td>SCS</td> <td>3</td> <td><a href=https://github.com/mlim70>mlim70</a></td> </tr> <tr> <td>Justin Xu</td> <td>Junior</td> <td>Computer Science</td> <td>SCS</td> <td>2</td> <td><a href=https://github.com/JXU037>JXU037</a></td> </tr> <tr> <td>Devam Mondal</td> <td>Senior</td> <td>Computer Science</td> <td>SCS</td> <td>3</td> <td><a href=https://github.com/Dodesimo>Dodesimo</a></td> </tr> <tr> <td>Nithish Sabapathy</td> <td>Senior</td> <td>Computer Science</td> <td>SCS</td> <td>2</td> <td><a href=https://github.com/nithish101>nithish101</a></td> </tr> <tr> <td>Ian Baracskay</td> <td>Senior</td> <td>Computer Engineering</td> <td>ECE</td> <td>1</td> <td><a href=https://github.com/ianBaracskay>ianBaracskay</a></td> </tr> <tr> <td>Jason Tran</td> <td>Junior</td> <td>Computer Science</td> <td>SCS</td> <td>1</td> <td><a href=https://github.com/JTran86>JTran86</a></td> </tr> </tbody> </table> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="January 6, 2026 20:42:49 EST"><span class=timeago datetime=2026-01-06T20:42:49-05:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="January 6, 2026 20:42:49 EST">2026-01-06</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 5.5A3.5 3.5 0 0 1 15.5 9a3.5 3.5 0 0 1-3.5 3.5A3.5 3.5 0 0 1 8.5 9 3.5 3.5 0 0 1 12 5.5M5 8c.56 0 1.08.15 1.53.42-.15 1.43.27 2.85 1.13 3.96C7.16 13.34 6.16 14 5 14a3 3 0 0 1-3-3 3 3 0 0 1 3-3m14 0a3 3 0 0 1 3 3 3 3 0 0 1-3 3c-1.16 0-2.16-.66-2.66-1.62a5.54 5.54 0 0 0 1.13-3.96c.45-.27.97-.42 1.53-.42M5.5 18.25c0-2.07 2.91-3.75 6.5-3.75s6.5 1.68 6.5 3.75V20h-13zM0 20v-1.5c0-1.39 1.89-2.56 4.45-2.9-.59.68-.95 1.62-.95 2.65V20zm24 0h-3.5v-1.75c0-1.03-.36-1.97-.95-2.65 2.56.34 4.45 1.51 4.45 2.9z"></path></svg> </span> <nav> </nav> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../25fa-medialaxis/ class="md-footer__link md-footer__link--prev" aria-label="Previous: 25-Fa-MedialAxis"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> 25-Fa-MedialAxis </div> </div> </a> <a href=../25fa-energyinbuildings/ class="md-footer__link md-footer__link--next" aria-label="Next: 25-Fa-Energy"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> 25-Fa-Energy </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright © 2023-2025 Sustainable Urban Systems Lab. <a href=https://siddharthdasari.com/ >Design credits.</a><p><a href=https://github.com/VIP-SMUR/vip-smur.github.io/actions><img alt="Last Built" src="https://img.shields.io/badge/dynamic/json?url=https%3A%2F%2Fapi.github.com%2Frepos%2FVIP-SMUR%2Fvip-smur.github.io%2Factions%2Fworkflows%2F119410802%2Fruns%3Fstatus%3Dcompleted%26per_page%3D1&query=%24.workflow_runs%5B0%5D.run_started_at&style=flat-square&label=Last%20Built&cacheSeconds=720"></a> </p></div> </div> <div class=md-social> <a href=https://github.com/VIP-SMUR target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </a> <a href=https://www.researchgate.net/profile/Patrick-Kastner target=_blank rel=noopener title=www.researchgate.net class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M0 32v448h448V32zm262.2 334.4c-6.6 3-33.2 6-50-14.2-9.2-10.6-25.3-33.3-42.2-63.6-8.9 0-14.7 0-21.4-.6v46.4c0 23.5 6 21.2 25.8 23.9v8.1c-6.9-.3-23.1-.8-35.6-.8-13.1 0-26.1.6-33.6.8v-8.1c15.5-2.9 22-1.3 22-23.9V225c0-22.6-6.4-21-22-23.9V193c25.8 1 53.1-.6 70.9-.6 31.7 0 55.9 14.4 55.9 45.6 0 21.1-16.7 42.2-39.2 47.5 13.6 24.2 30 45.6 42.2 58.9 7.2 7.8 17.2 14.7 27.2 14.7zm22.9-135c-23.3 0-32.2-15.7-32.2-32.2V167c0-12.2 8.8-30.4 34-30.4s30.4 17.9 30.4 17.9l-10.7 7.2s-5.5-12.5-19.7-12.5c-7.9 0-19.7 7.3-19.7 19.7v26.8c0 13.4 6.6 23.3 17.9 23.3 14.1 0 21.5-10.9 21.5-26.8h-17.9v-10.7h30.4c0 20.5 4.7 49.9-34 49.9m-116.5 44.7c-9.4 0-13.6-.3-20-.8v-69.7c6.4-.6 15-.6 22.5-.6 23.3 0 37.2 12.2 37.2 34.5 0 21.9-15 36.6-39.7 36.6"></path></svg> </a> <a href=https://gscholar.patrickkastner.de/ target=_blank rel=noopener title=gscholar.patrickkastner.de class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M390.9 298.5s0 .1.1.1c9.2 19.4 14.4 41.1 14.4 64C405.3 445.1 338.5 512 256 512s-149.3-66.9-149.3-149.3c0-22.9 5.2-44.6 14.4-64 1.7-3.6 3.6-7.2 5.6-10.7q6.6-11.4 15-21.3c27.4-32.6 68.5-53.3 114.4-53.3 33.6 0 64.6 11.1 89.6 29.9 9.1 6.9 17.4 14.7 24.8 23.5 5.6 6.6 10.6 13.8 15 21.3 2 3.4 3.8 7 5.5 10.5zm26.4-18.8c-30.1-58.4-91-98.4-161.3-98.4s-131.2 40-161.3 98.4L0 202.7 256 0l256 202.7-94.7 77.1z"></path></svg> </a> <a href=https://www.linkedin.com/in/patrickkastner/ target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"></path></svg> </a> <a href=https://orcid.org/0000-0003-4940-341X target=_blank rel=noopener title=orcid.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M294.7 188.2h-45.9V342h47.5c67.6 0 83.1-51.3 83.1-76.9 0-41.6-26.5-76.9-84.7-76.9M256 8a248 248 0 1 0 0 496 248 248 0 1 0 0-496m-80.8 360.8h-29.8V161.3h29.8zM160.3 98.5a19.6 19.6 0 1 1 0 39.2 19.6 19.6 0 1 1 0-39.2M300 369h-81V161.3h80.6c76.7 0 110.4 54.8 110.4 103.9 0 53.3-41.7 103.9-110 103.9z"></path></svg> </a> <a href=https://vip-smur.github.io/feed_rss_created.xml target=_blank rel=noopener title=vip-smur.github.io class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h320c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64zm32 104c0-13.3 10.7-24 24-24 137 0 248 111 248 248 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-110.5-89.5-200-200-200-13.3 0-24-10.7-24-24m0 96c0-13.3 10.7-24 24-24 83.9 0 152 68.1 152 152 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-57.4-46.6-104-104-104-13.3 0-24-10.7-24-24m0 120a32 32 0 1 1 64 0 32 32 0 1 1-64 0"></path></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"annotate": null, "base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "navigation.path", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": {"Energy": "energy", "Microclimate": "microclimate", "Mobility": "mobility"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../assets/javascripts/bundle.e71a0d61.min.js></script> <script src=../js/timeago.min.js></script> <script src=../js/timeago_mkdocs_material.js></script> <script src=../javascripts/tablesort.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../javascripts/mathjax.js></script> <script src=https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>